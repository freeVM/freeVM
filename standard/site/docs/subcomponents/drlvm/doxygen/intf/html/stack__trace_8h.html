<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Inter-component Interfaces: stack_trace.h File Reference</title>
<link href="hydoxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.2 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="namespaces.html"><span>Packages</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul>
</div>
<h1>stack_trace.h File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
Mechanism for tracing the stack of Java and native code. 
<p>
This module provides stack traces. A <b>stack trace</b> is a sequence of frames counting from the top to the bottom of the stack.<p>
The stack trace inlcudes one frame for each managed stack frame and one frame for each M2N frame that has an associated method. For each frame, the method and the IP are provided and, optionally, the file and line number.<p>
The current implementation supports the following types of frames:<p>
<ul>
<li>
Managed code frames corresponding to Java code </li>
<li>
Managed-to-native frames (M2N) for transferring data and control between managed and native frames<p>
Native frames iteration is not currently supported. To iterate over native frames, use OS-provided tools. </li>
</ul>

<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_stack_trace_frame.html">StackTraceFrame</a></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">VMEXPORT unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="stack__trace_8h.html#d1d3f801cfee1c2e4a171a616da6a549">st_get_depth</a> (<a class="el" href="struct_v_m__thread.html">VM_thread</a> *p_vmthread)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets the depth of the stack trace for the specified thread.  <a href="#d1d3f801cfee1c2e4a171a616da6a549"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">VMEXPORT bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="stack__trace_8h.html#d2ea5b0b498fac477086e99209ab56f5">st_get_frame</a> (unsigned <a class="el" href="jvmti__types_8h.html#9f024458ae4036343ea096b6bf516365">depth</a>, <a class="el" href="struct_stack_trace_frame.html">StackTraceFrame</a> *stf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Fills the stack trace frame at the given relative depth for the current thread.  <a href="#d2ea5b0b498fac477086e99209ab56f5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">VMEXPORT <a class="el" href="struct_stack_trace_frame.html">StackTraceFrame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="stack__trace_8h.html#4fb352de4d4d6030b467a523772552c3">st_alloc_frames</a> (int num)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Allocates memory required for the given number of stack trace frames.  <a href="#4fb352de4d4d6030b467a523772552c3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">VMEXPORT void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="stack__trace_8h.html#1dc46ea8ffe2eb02c702065a8193f379">st_get_trace</a> (<a class="el" href="struct_v_m__thread.html">VM_thread</a> *p_vmthread, unsigned *<a class="el" href="jvmti__types_8h.html#9f024458ae4036343ea096b6bf516365">depth</a>, <a class="el" href="struct_stack_trace_frame.html">StackTraceFrame</a> **stfs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Fills the stack trace frames for the specified number of frames of the specified thread.  <a href="#1dc46ea8ffe2eb02c702065a8193f379"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">VMEXPORT void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="stack__trace_8h.html#631873bd6a86df56581b1f5739140a99">get_file_and_line</a> (<a class="el" href="types_8h.html#66381b1c7f38273ba98e3c43f2ddf041">Method_Handle</a> <a class="el" href="jvmti__types_8h.html#03510b7e66271c729c629f2342b44c82">method</a>, void *ip, bool is_ip_past, int <a class="el" href="jvmti__types_8h.html#9f024458ae4036343ea096b6bf516365">depth</a>, const char **file, int *line)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Fills the given pointer to a source file and line number by using the given method and IP.  <a href="#631873bd6a86df56581b1f5739140a99"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="stack__trace_8h.html#545ab98c0e8f4cff420c7b93eadee8b6">st_print_frame</a> (<a class="el" href="class_expandable_mem_block.html">ExpandableMemBlock</a> *buf, <a class="el" href="struct_stack_trace_frame.html">StackTraceFrame</a> *stf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Appends data about the given frame to the expandable buffer in a human-readable form.  <a href="#545ab98c0e8f4cff420c7b93eadee8b6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="stack__trace_8h.html#29de491273abd10f6925df4ac443733a">st_print_all</a> (FILE *f)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Prints stack trace of all java threads.  <a href="#29de491273abd10f6925df4ac443733a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="stack__trace_8h.html#94a50fbe53693f1071fa6fefa48e1db0">st_print</a> (FILE *f, <a class="el" href="struct_hy_thread.html">hythread_t</a> <a class="el" href="jvmti__types_8h.html#f4792ab343238a594fcb4f8250056e9a">thread</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Prints the current java thread stack trace into specified stream.  <a href="#94a50fbe53693f1071fa6fefa48e1db0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="stack__trace_8h.html#aebdde719f2ae74c6001d091ac9920ab">st_print</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Prints the current java thread stack trace into the <code>stderr</code> stream.  <a href="#aebdde719f2ae74c6001d091ac9920ab"></a><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="d1d3f801cfee1c2e4a171a616da6a549"></a><!-- doxytag: member="stack_trace.h::st_get_depth" ref="d1d3f801cfee1c2e4a171a616da6a549" args="(VM_thread *p_vmthread)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VMEXPORT unsigned st_get_depth           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_v_m__thread.html">VM_thread</a> *&nbsp;</td>
          <td class="paramname"> <em>p_vmthread</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets the depth of the stack trace for the specified thread. 
<p>
The <b>depth</b> is the number of supported stack frames in the current thread stack, from most recently pushed to the first pushed. The depth also includes the number of inlined methods.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>p_vmthread</em>&nbsp;</td><td>- pointer to the thread</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The number of frames above the current one including the current frame and inlined methods. </dd></dl>

</div>
</div><p>
<a class="anchor" name="d2ea5b0b498fac477086e99209ab56f5"></a><!-- doxytag: member="stack_trace.h::st_get_frame" ref="d2ea5b0b498fac477086e99209ab56f5" args="(unsigned depth, StackTraceFrame *stf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VMEXPORT bool st_get_frame           </td>
          <td>(</td>
          <td class="paramtype">unsigned&nbsp;</td>
          <td class="paramname"> <em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_stack_trace_frame.html">StackTraceFrame</a> *&nbsp;</td>
          <td class="paramname"> <em>stf</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Fills the stack trace frame at the given relative depth for the current thread. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>depth</em>&nbsp;</td><td>- relative depth of a frame or inlined method on the stack, topmost frame has zero depth. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stf</em>&nbsp;</td><td>- the pointer to the <code><a class="el" href="struct_stack_trace_frame.html">StackTraceFrame</a></code> structure that needs to be filled with the data on the frame or inlined method corresponding to the given depth</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><code>TRUE</code> on success, <code>FALSE</code> if the depth is greater than or equal to thecurrent thread's stack trace length. </dd></dl>

</div>
</div><p>
<a class="anchor" name="4fb352de4d4d6030b467a523772552c3"></a><!-- doxytag: member="stack_trace.h::st_alloc_frames" ref="4fb352de4d4d6030b467a523772552c3" args="(int num)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VMEXPORT <a class="el" href="struct_stack_trace_frame.html">StackTraceFrame</a>* st_alloc_frames           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>num</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Allocates memory required for the given number of stack trace frames. 
<p>
Used internaly by the interpreter to avoid memory allocation/de-allocation conflicts in the VM and DLLs on Windows / IA-32 systems.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>num</em>&nbsp;</td><td>- required number of stack trace frames</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The pointer to the allocated array of stack trace frames.</dd></dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>The caller is responsible for freeing the memory. </dd></dl>

</div>
</div><p>
<a class="anchor" name="1dc46ea8ffe2eb02c702065a8193f379"></a><!-- doxytag: member="stack_trace.h::st_get_trace" ref="1dc46ea8ffe2eb02c702065a8193f379" args="(VM_thread *p_vmthread, unsigned *depth, StackTraceFrame **stfs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VMEXPORT void st_get_trace           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_v_m__thread.html">VM_thread</a> *&nbsp;</td>
          <td class="paramname"> <em>p_vmthread</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&nbsp;</td>
          <td class="paramname"> <em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_stack_trace_frame.html">StackTraceFrame</a> **&nbsp;</td>
          <td class="paramname"> <em>stfs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Fills the stack trace frames for the specified number of frames of the specified thread. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>p_vmthread</em>&nbsp;</td><td>- pointer to the thread </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>depth</em>&nbsp;</td><td>- the number of frames including inlined methods, information about which should be stored </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stfs</em>&nbsp;</td><td>- the pointer to the array of stack trace frames created by this function and returned via this pointer.</td></tr>
  </table>
</dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>The caller is responsible for freeing the memory. </dd></dl>

</div>
</div><p>
<a class="anchor" name="631873bd6a86df56581b1f5739140a99"></a><!-- doxytag: member="stack_trace.h::get_file_and_line" ref="631873bd6a86df56581b1f5739140a99" args="(Method_Handle method, void *ip, bool is_ip_past, int depth, const char **file, int *line)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VMEXPORT void get_file_and_line           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#66381b1c7f38273ba98e3c43f2ddf041">Method_Handle</a>&nbsp;</td>
          <td class="paramname"> <em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>is_ip_past</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>line</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Fills the given pointer to a source file and line number by using the given method and IP. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>method</em>&nbsp;</td><td>- the handle of the method information to identify the source file </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ip</em>&nbsp;</td><td>- the instruction pointer to identify the JIT and using the JIT line number </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>depth</em>&nbsp;</td><td>- the inlined depth for inlined methods; (-1) for native methods and methods which were not inlined </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>file</em>&nbsp;</td><td>- the pointer to the file reference to be filled by this function </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>line</em>&nbsp;</td><td>- the pointer to the line number to be filled by this function </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="545ab98c0e8f4cff420c7b93eadee8b6"></a><!-- doxytag: member="stack_trace.h::st_print_frame" ref="545ab98c0e8f4cff420c7b93eadee8b6" args="(ExpandableMemBlock *buf, StackTraceFrame *stf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void st_print_frame           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_expandable_mem_block.html">ExpandableMemBlock</a> *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_stack_trace_frame.html">StackTraceFrame</a> *&nbsp;</td>
          <td class="paramname"> <em>stf</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Appends data about the given frame to the expandable buffer in a human-readable form. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>buf</em>&nbsp;</td><td>- the pointer to <code><a class="el" href="class_expandable_mem_block.html">ExpandableMemBlock</a></code>, where data will be added </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stf</em>&nbsp;</td><td>- the pointer to the stack trace frame, data from which will be printed into buffer </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="29de491273abd10f6925df4ac443733a"></a><!-- doxytag: member="stack_trace.h::st_print_all" ref="29de491273abd10f6925df4ac443733a" args="(FILE *f)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void st_print_all           </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>f</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Prints stack trace of all java threads. 
<p>
This function supports and prints all Java frames.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>f</em>&nbsp;</td><td>- the pointer to the file, where the stack trace will be printed</td></tr>
  </table>
</dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>Intended for debugging purposes. </dd></dl>

</div>
</div><p>
<a class="anchor" name="94a50fbe53693f1071fa6fefa48e1db0"></a><!-- doxytag: member="stack_trace.h::st_print" ref="94a50fbe53693f1071fa6fefa48e1db0" args="(FILE *f, hythread_t thread)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void st_print           </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_hy_thread.html">hythread_t</a>&nbsp;</td>
          <td class="paramname"> <em>thread</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Prints the current java thread stack trace into specified stream. 
<p>
This function supports and prints all Java frames.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>f</em>&nbsp;</td><td>- the pointer to the file, where the stack trace will be printed </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>thread</em>&nbsp;</td><td>- the thread wich stack should be printed</td></tr>
  </table>
</dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>Intended for debugging purposes. </dd></dl>

</div>
</div><p>
<a class="anchor" name="aebdde719f2ae74c6001d091ac9920ab"></a><!-- doxytag: member="stack_trace.h::st_print" ref="aebdde719f2ae74c6001d091ac9920ab" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void st_print           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Prints the current java thread stack trace into the <code>stderr</code> stream. 
<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>Intended for debugging purposes. </dd></dl>

</div>
</div><p>
<hr size="1">
<address style="text-align: center;">
  <small>
    <p>Genereated on Tue Mar 11 19:25:23 2008 by Doxygen.</p>
    <p>(c) Copyright 2005, 2008 The Apache Software Foundation or its licensors, as applicable. </p>
  </small>
</address>
</body>
</html>
