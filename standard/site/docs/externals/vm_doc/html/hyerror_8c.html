<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Harmony Class Library Porting: modules/portlib/src/main/native/port/shared/hyerror.c File Reference</title>
<link href="hydoxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.4 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<h1>modules/portlib/src/main/native/port/shared/hyerror.c File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
Error Handling. 
<p>
If an OS system call fails the error code reported by the OS needs to be saved for future reference. The OS error code as well as the corresponding portable error code are stored in the per thread buffers <a class="el" href="hyportptb_8h.html">hyportptb.h</a> via a call the <a class="el" href="hyerror_8c.html#da4acdc71eab1c5cd89a24e278367eca">hyerror_set_last_error</a> or <a class="el" href="hyerror_8c.html#a642dfe228e36b6229d666eb6c3ce9fd">hyerror_set_last_error_with_message</a>. These functions are meant for private use by the port library, to set the error related to a system call failure. They are in the port library table as people overriding port library functions may need to set the error message accordingly.<p>
The majority of applications are not interested in the human readable error message corresponding to the error. As a result the error message is not stored at time of the reported error, but can be looked up at a later time. 
<p>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &quot;portpriv.h&quot;</code><br>
<code>#include &quot;portnls.h&quot;</code><br>
<code>#include &quot;<a class="el" href="hyportptb_8h.html">hyportptb.h</a>&quot;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">I_32 VMCALL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hyerror_8c.html#adbadeb1e22c4cd8ae10e8a6a7ad81fc">hyerror_startup</a> (struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *portLibrary)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">PortLibrary startup.  <a href="#adbadeb1e22c4cd8ae10e8a6a7ad81fc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void VMCALL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hyerror_8c.html#a742363b27375fe4e706e0609619ed16">hyerror_shutdown</a> (struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *portLibrary)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">PortLibrary shutdown.  <a href="#a742363b27375fe4e706e0609619ed16"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *VMCALL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hyerror_8c.html#658e173b555555af2f142179132467e6">hyerror_last_error_message</a> (struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *portLibrary)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Error Handling.  <a href="#658e173b555555af2f142179132467e6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">I_32 VMCALL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hyerror_8c.html#fecda83d106304c8c24ab2c173a14f53">hyerror_last_error_number</a> (struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *portLibrary)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Error Handling.  <a href="#fecda83d106304c8c24ab2c173a14f53"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">I_32 VMCALL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hyerror_8c.html#da4acdc71eab1c5cd89a24e278367eca">hyerror_set_last_error</a> (struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *portLibrary, I_32 platformCode, I_32 portableCode)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Error Handling.  <a href="#da4acdc71eab1c5cd89a24e278367eca"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">I_32 VMCALL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hyerror_8c.html#a642dfe228e36b6229d666eb6c3ce9fd">hyerror_set_last_error_with_message</a> (struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *portLibrary, I_32 portableCode, const char *errorMessage)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Error Handling.  <a href="#a642dfe228e36b6229d666eb6c3ce9fd"></a><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="658e173b555555af2f142179132467e6"></a><!-- doxytag: member="hyerror.c::hyerror_last_error_message" ref="658e173b555555af2f142179132467e6" args="(struct HyPortLibrary *portLibrary)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* VMCALL hyerror_last_error_message           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *&nbsp;</td>
          <td class="paramname"> <em>portLibrary</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Error Handling. 
<p>
Return the error message as reported by the OS for the last saved error. If no error has been saved then an empty message is returned.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>portLibrary</em>&nbsp;</td><td>The port library</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The error message for the last OS failure, empty message on failure. </dd></dl>

</div>
</div><p>
<a class="anchor" name="fecda83d106304c8c24ab2c173a14f53"></a><!-- doxytag: member="hyerror.c::hyerror_last_error_number" ref="fecda83d106304c8c24ab2c173a14f53" args="(struct HyPortLibrary *portLibrary)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">I_32 VMCALL hyerror_last_error_number           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *&nbsp;</td>
          <td class="paramname"> <em>portLibrary</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Error Handling. 
<p>
Look up the reason for the last stored failure. If no error code has been stored then failure is returned.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>portLibrary</em>&nbsp;</td><td>The port library</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The negative portable error code on success, 0 on failure.</dd></dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>Does not clear the reason for the last failure. </dd></dl>

</div>
</div><p>
<a class="anchor" name="da4acdc71eab1c5cd89a24e278367eca"></a><!-- doxytag: member="hyerror.c::hyerror_set_last_error" ref="da4acdc71eab1c5cd89a24e278367eca" args="(struct HyPortLibrary *portLibrary, I_32 platformCode, I_32 portableCode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">I_32 VMCALL hyerror_set_last_error           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *&nbsp;</td>
          <td class="paramname"> <em>portLibrary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">I_32&nbsp;</td>
          <td class="paramname"> <em>platformCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">I_32&nbsp;</td>
          <td class="paramname"> <em>portableCode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Error Handling. 
<p>
Save the platform specific error code and the portable error code for future reference. Once stored an application may obtain the error message describing the last stored error by calling hyerror_last_error_message. Likewise the last portable error code can be obtained by calling hyerror_last_error_number.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>portLibrary</em>&nbsp;</td><td>The port library </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>platformCode</em>&nbsp;</td><td>The error code reported by the OS </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>portableCode</em>&nbsp;</td><td>The corresponding portable error code as determined by the caller</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>portable error code</dd></dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>There is no way to access the last platform specific error code.<p>
If per thread buffers </dd></dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="hyportptb_8h.html" title="Per Thread Buffers.">hyportptb.h</a> are not available the error code is not stored. This event would only occur if the per thread buffers could not be allocated, which is highly unlikely. In this case an application will receive a generic message/errorCode when querying for the last stored values. </dd></dl>

</div>
</div><p>
<a class="anchor" name="a642dfe228e36b6229d666eb6c3ce9fd"></a><!-- doxytag: member="hyerror.c::hyerror_set_last_error_with_message" ref="a642dfe228e36b6229d666eb6c3ce9fd" args="(struct HyPortLibrary *portLibrary, I_32 portableCode, const char *errorMessage)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">I_32 VMCALL hyerror_set_last_error_with_message           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *&nbsp;</td>
          <td class="paramname"> <em>portLibrary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">I_32&nbsp;</td>
          <td class="paramname"> <em>portableCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>errorMessage</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Error Handling. 
<p>
Save the platform specific error code and the portable error code for future reference. Once stored an application may obtain the error message describing the last stored error by calling hyerror_last_error_message. Likewise the last portable error code can be obtained by calling hyerror_last_error_number.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>portLibrary</em>&nbsp;</td><td>The port library </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>portableCode</em>&nbsp;</td><td>The corresponding portable error code as determined by the caller </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>errorMessage</em>&nbsp;</td><td>The customized error message to be stored</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>portable error code</dd></dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>There is no way to access the last platform specific error code.<p>
If per thread buffers </dd></dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="hyportptb_8h.html" title="Per Thread Buffers.">hyportptb.h</a> are not available the error code is not stored. This event would only occur if the per thread buffers could not be allocated, which is highly unlikely. In this case an application will receive a generic message/errorCode when querying for the last stored values. </dd></dl>

</div>
</div><p>
<a class="anchor" name="a742363b27375fe4e706e0609619ed16"></a><!-- doxytag: member="hyerror.c::hyerror_shutdown" ref="a742363b27375fe4e706e0609619ed16" args="(struct HyPortLibrary *portLibrary)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VMCALL hyerror_shutdown           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *&nbsp;</td>
          <td class="paramname"> <em>portLibrary</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
PortLibrary shutdown. 
<p>
This function is called during shutdown of the portLibrary. Any resources that were created by <a class="el" href="hyerror_8c.html#adbadeb1e22c4cd8ae10e8a6a7ad81fc">hyerror_startup</a> should be destroyed here.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>portLibrary</em>&nbsp;</td><td>The port library</td></tr>
  </table>
</dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>Most implementations will be empty. </dd></dl>

</div>
</div><p>
<a class="anchor" name="adbadeb1e22c4cd8ae10e8a6a7ad81fc"></a><!-- doxytag: member="hyerror.c::hyerror_startup" ref="adbadeb1e22c4cd8ae10e8a6a7ad81fc" args="(struct HyPortLibrary *portLibrary)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">I_32 VMCALL hyerror_startup           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *&nbsp;</td>
          <td class="paramname"> <em>portLibrary</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
PortLibrary startup. 
<p>
This function is called during startup of the portLibrary. Any resources that are required for the error handling operations may be created here. All resources created here should be destroyed in <a class="el" href="hyerror_8c.html#a742363b27375fe4e706e0609619ed16">hyerror_shutdown</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>portLibrary</em>&nbsp;</td><td>The port library</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, negative error code on failure. Error code values returned are <ul>
<li>HYPORT_ERROR_STARTUP_ERROR</li>
</ul>
</dd></dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>Most implementations will simply return success. </dd></dl>

</div>
</div><p>
<hr size="1">
<address style="text-align: center;">
  <small>
    <p>Genereated on Tue Dec 9 14:12:59 2008 by Doxygen.</p>
    <p>(c) Copyright 2005, 2008 The Apache Software Foundation or its licensors, as applicable. </p>
  </small>
</address>
</body>
</html>
