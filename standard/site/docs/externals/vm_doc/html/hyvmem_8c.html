<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Harmony Class Library Porting: modules/portlib/src/main/native/port/windows/hyvmem.c File Reference</title>
<link href="hydoxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.4 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<h1>modules/portlib/src/main/native/port/windows/hyvmem.c File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
Virtual memory. 
<p>

<p>
<code>#include &lt;windows.h&gt;</code><br>
<code>#include &quot;<a class="el" href="hyport_8h.html">hyport.h</a>&quot;</code><br>
<code>#include &quot;portpriv.h&quot;</code><br>
<code>#include &quot;hyportpg.h&quot;</code><br>
<code>#include &quot;ut_hyprt.h&quot;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void *VMCALL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hyvmem_8c.html#f91251d4c96430fa888e9929663a2cfe">hyvmem_commit_memory</a> (struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *portLibrary, void *address, UDATA byteAmount, struct HyPortVmemIdentifier *identifier)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Commit memory in virtual address space.  <a href="#f91251d4c96430fa888e9929663a2cfe"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">IDATA VMCALL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hyvmem_8c.html#0aa48435d552a7933db8514d375f5940">hyvmem_decommit_memory</a> (struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *portLibrary, void *address, UDATA byteAmount, struct HyPortVmemIdentifier *identifier)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Decommit memory in virtual address space.  <a href="#0aa48435d552a7933db8514d375f5940"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">I_32 VMCALL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hyvmem_8c.html#2bb1f12e3fa331fdc71f96e89d224f2e">hyvmem_free_memory</a> (struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *portLibrary, void *address, UDATA byteAmount, struct HyPortVmemIdentifier *identifier)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Free memory in virtual address space.  <a href="#2bb1f12e3fa331fdc71f96e89d224f2e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void *VMCALL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hyvmem_8c.html#20fad5579608f39b8453830d1190f733">hyvmem_reserve_memory</a> (struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *portLibrary, void *address, UDATA byteAmount, struct HyPortVmemIdentifier *identifier, UDATA mode, UDATA pageSize)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reserve memory in virtual address space.  <a href="#20fad5579608f39b8453830d1190f733"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void VMCALL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hyvmem_8c.html#3f10e5638af9a01c538cecdb0069ac42">hyvmem_shutdown</a> (struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *portLibrary)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">PortLibrary shutdown.  <a href="#3f10e5638af9a01c538cecdb0069ac42"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">I_32 VMCALL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hyvmem_8c.html#863116955eb18244795686f3988cd564">hyvmem_startup</a> (struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *portLibrary)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">PortLibrary startup.  <a href="#863116955eb18244795686f3988cd564"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">UDATA *VMCALL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hyvmem_8c.html#0c145a88a8a2886bfd815e1c9f92fb94">hyvmem_supported_page_sizes</a> (struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *portLibrary)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Determine the page sizes supported.  <a href="#0c145a88a8a2886bfd815e1c9f92fb94"></a><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="f91251d4c96430fa888e9929663a2cfe"></a><!-- doxytag: member="hyvmem.c::hyvmem_commit_memory" ref="f91251d4c96430fa888e9929663a2cfe" args="(struct HyPortLibrary *portLibrary, void *address, UDATA byteAmount, struct HyPortVmemIdentifier *identifier)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* VMCALL hyvmem_commit_memory           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *&nbsp;</td>
          <td class="paramname"> <em>portLibrary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UDATA&nbsp;</td>
          <td class="paramname"> <em>byteAmount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct HyPortVmemIdentifier *&nbsp;</td>
          <td class="paramname"> <em>identifier</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Commit memory in virtual address space. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>portLibrary</em>&nbsp;</td><td>The port library. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>address</em>&nbsp;</td><td>The page aligned starting address of the memory to commit. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>byteAmount</em>&nbsp;</td><td>The number of bytes to commit. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>identifier</em>&nbsp;</td><td>Descriptor for virtual memory block.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>pointer to the allocated memory on success, NULL on failure. </dd></dl>

</div>
</div><p>
<a class="anchor" name="0aa48435d552a7933db8514d375f5940"></a><!-- doxytag: member="hyvmem.c::hyvmem_decommit_memory" ref="0aa48435d552a7933db8514d375f5940" args="(struct HyPortLibrary *portLibrary, void *address, UDATA byteAmount, struct HyPortVmemIdentifier *identifier)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IDATA VMCALL hyvmem_decommit_memory           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *&nbsp;</td>
          <td class="paramname"> <em>portLibrary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UDATA&nbsp;</td>
          <td class="paramname"> <em>byteAmount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct HyPortVmemIdentifier *&nbsp;</td>
          <td class="paramname"> <em>identifier</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Decommit memory in virtual address space. 
<p>
Decommits physical storage of the size specified starting at the address specified.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>portLibrary</em>&nbsp;</td><td>The port library. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>address</em>&nbsp;</td><td>The starting address of the memory to be decommitted. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>byteAmount</em>&nbsp;</td><td>The number of bytes to be decommitted. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>identifier</em>&nbsp;</td><td>Descriptor for virtual memory block.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, non zero on failure. </dd></dl>

</div>
</div><p>
<a class="anchor" name="2bb1f12e3fa331fdc71f96e89d224f2e"></a><!-- doxytag: member="hyvmem.c::hyvmem_free_memory" ref="2bb1f12e3fa331fdc71f96e89d224f2e" args="(struct HyPortLibrary *portLibrary, void *address, UDATA byteAmount, struct HyPortVmemIdentifier *identifier)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">I_32 VMCALL hyvmem_free_memory           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *&nbsp;</td>
          <td class="paramname"> <em>portLibrary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UDATA&nbsp;</td>
          <td class="paramname"> <em>byteAmount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct HyPortVmemIdentifier *&nbsp;</td>
          <td class="paramname"> <em>identifier</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Free memory in virtual address space. 
<p>
Frees physical storage of the size specified starting at the address specified.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>portLibrary</em>&nbsp;</td><td>The port library. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>address</em>&nbsp;</td><td>The starting address of the memory to be de-allocated. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>byteAmount</em>&nbsp;</td><td>The number of bytes to be allocated. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>identifier</em>&nbsp;</td><td>Descriptor for virtual memory block.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, non zero on failure. </dd></dl>

</div>
</div><p>
<a class="anchor" name="20fad5579608f39b8453830d1190f733"></a><!-- doxytag: member="hyvmem.c::hyvmem_reserve_memory" ref="20fad5579608f39b8453830d1190f733" args="(struct HyPortLibrary *portLibrary, void *address, UDATA byteAmount, struct HyPortVmemIdentifier *identifier, UDATA mode, UDATA pageSize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* VMCALL hyvmem_reserve_memory           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *&nbsp;</td>
          <td class="paramname"> <em>portLibrary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UDATA&nbsp;</td>
          <td class="paramname"> <em>byteAmount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct HyPortVmemIdentifier *&nbsp;</td>
          <td class="paramname"> <em>identifier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UDATA&nbsp;</td>
          <td class="paramname"> <em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UDATA&nbsp;</td>
          <td class="paramname"> <em>pageSize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Reserve memory in virtual address space. 
<p>
Reserves a range of virtual address space without allocating any actual physical storage. The memory is not available for use until committed <a class="el" href="hyvmem_8c.html#f91251d4c96430fa888e9929663a2cfe">hyvmem_commit_memory</a>. The memory may not be used by other memory allocation routines until it is explicitly released.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>portLibrary</em>&nbsp;</td><td>The port library. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>address</em>&nbsp;</td><td>The starting address of the memory to be reserved. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>byteAmount</em>&nbsp;</td><td>The number of bytes to be reserved. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>identifier</em>&nbsp;</td><td>Descriptor for virtual memory block. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>mode</em>&nbsp;</td><td>Bitmap indicating how memory is to be reserved. Expected values combination of: <ul>
<li>HYPORT_VMEM_MEMORY_MODE_READ memory is readable </li>
<li>HYPORT_VMEM_MEMORY_MODE_WRITE memory is writable </li>
<li>HYPORT_VMEM_MEMORY_MODE_EXECUTE memory is executable </li>
<li>HYPORT_VMEM_MEMORY_MODE_COMMIT commits memory as part of the reserve </li>
</ul>
</td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pageSize</em>&nbsp;</td><td>Size of the page requested, a value returned by <a class="el" href="hyvmem_8c.html#0c145a88a8a2886bfd815e1c9f92fb94">hyvmem_supported_page_sizes</a>, or the constant HYPORT_VMEM_PAGE_SIZE_DEFAULT for the system default page size.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>pointer to the reserved memory on success, NULL on failure. </dd></dl>

</div>
</div><p>
<a class="anchor" name="3f10e5638af9a01c538cecdb0069ac42"></a><!-- doxytag: member="hyvmem.c::hyvmem_shutdown" ref="3f10e5638af9a01c538cecdb0069ac42" args="(struct HyPortLibrary *portLibrary)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VMCALL hyvmem_shutdown           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *&nbsp;</td>
          <td class="paramname"> <em>portLibrary</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
PortLibrary shutdown. 
<p>
This function is called during shutdown of the portLibrary. Any resources that were created by <a class="el" href="hyvmem_8c.html#863116955eb18244795686f3988cd564">hyvmem_startup</a> should be destroyed here.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>portLibrary</em>&nbsp;</td><td>The port library.</td></tr>
  </table>
</dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>Most implementations will be empty. </dd></dl>

</div>
</div><p>
<a class="anchor" name="863116955eb18244795686f3988cd564"></a><!-- doxytag: member="hyvmem.c::hyvmem_startup" ref="863116955eb18244795686f3988cd564" args="(struct HyPortLibrary *portLibrary)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">I_32 VMCALL hyvmem_startup           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *&nbsp;</td>
          <td class="paramname"> <em>portLibrary</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
PortLibrary startup. 
<p>
This function is called during startup of the portLibrary. Any resources that are required for the virtual memory operations may be created here. All resources created here should be destroyed in <a class="el" href="hyvmem_8c.html#3f10e5638af9a01c538cecdb0069ac42">hyvmem_shutdown</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>portLibrary</em>&nbsp;</td><td>The port library.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, negative error code on failure. Error code values returned are <ul>
<li>HYPORT_ERROR_STARTUP_VMEM</li>
</ul>
</dd></dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>Most implementations will simply return success. </dd></dl>

</div>
</div><p>
<a class="anchor" name="0c145a88a8a2886bfd815e1c9f92fb94"></a><!-- doxytag: member="hyvmem.c::hyvmem_supported_page_sizes" ref="0c145a88a8a2886bfd815e1c9f92fb94" args="(struct HyPortLibrary *portLibrary)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UDATA* VMCALL hyvmem_supported_page_sizes           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structHyPortLibrary.html">HyPortLibrary</a> *&nbsp;</td>
          <td class="paramname"> <em>portLibrary</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Determine the page sizes supported. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>portLibrary</em>&nbsp;</td><td>The port library.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A 0 terminated array of supported page sizes. The first entry is the default page size, other entries are the large page sizes supported. </dd></dl>

</div>
</div><p>
<hr size="1">
<address style="text-align: center;">
  <small>
    <p>Genereated on Tue Dec 9 14:13:00 2008 by Doxygen.</p>
    <p>(c) Copyright 2005, 2008 The Apache Software Foundation or its licensors, as applicable. </p>
  </small>
</address>
</body>
</html>
