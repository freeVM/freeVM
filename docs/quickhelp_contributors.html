<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<!--
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to You under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->


<!-- start the processing -->
    <!-- ====================================================================== -->
    <!-- GENERATED FILE, DO NOT EDIT, EDIT THE XML FILE IN xdocs INSTEAD! -->
    <!-- Main Page Section -->
    <!-- ====================================================================== -->
    <html>
        <head>
            <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>

                                                    <meta name="author" value="Harmony Documentation Team">
            <meta name="email" value="harmony-dev@incubator.apache.org">
            
           
            
            
            
            
            
            <title>Apache Harmony - Apache Harmony - Getting Started For Contributors</title>

                                <link rel="Stylesheet" type="text/css" href="site.css"/>
        </head>

        <body>        
            <table  width="100%" cellspacing="0">
                <!-- TOP IMAGE -->
                <tr>
                    <td align='LEFT'>
                    <table><tr><td>
                    <td>
<a href="http://incubator.apache.org/harmony/"><img  src="./images/harmony-logo.png" alt="Apache Harmony" /></a>
</td>
</td>
                    </td></tr></table>
                    </td>
                    <td align='RIGHT'>
                    <a href="http://incubator.apache.org/harmony/">
                    <img src="http://incubator.apache.org/harmony/images/apache-incubator-logo.png"
                    	alt="Apache Harmony" /></a>                    
                    </td>
                </tr>
            </table>
            <table width="100%" cellspacing="4">
                <tr><td colspan="2">
                    <hr noshade="" size="1"/>
                </td></tr>

                <tr>
                    <!-- LEFT SIDE NAVIGATION -->
                    <td class="menuItem" width="20%" nowrap="true">

                    <!-- special ACon Logo - leave here for next time
                    <a href="http://www.us.apachecon.com/">
                        <img src="http://www.apache.org/ads/ApacheCon/240x120-2006-us.gif"
                             alt="ApacheCon US 2006" />
                    </a> -->

                   <!-- regular menu -->

                    
    <!-- ============================================================ -->

                <p class="menuItem"><strong>General</strong></p>
        <ul>
                    <li class="menuItem">    <a href="./index.html">Home</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="./license.html">License</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="./contribution_policy.html">Contribution Policy</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="./guidelines.html">Project Guidelines</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="http://www.apache.org/">ASF</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="./downloads.html">Downloads</a>
</li>
            
           
                        
                </ul>
            <p class="menuItem"><strong>Community</strong></p>
        <ul>
                    <li class="menuItem">    <a href="./get-involved.html">Get Involved</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="./contributors.html">Committers</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="./mailing.html">Mailing Lists</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="./documentation/documentation.html">Documentation</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="./faq.html">FAQ</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="http://wiki.apache.org/harmony">Wiki</a>
</li>
            
           
                        
                </ul>
            <p class="menuItem"><strong>Development</strong></p>
        <ul>
                    <li class="menuItem">    <a href="./status.html">How Are We Doing?</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="./roadmap.html">Road Map / TODO</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="./svn.html">Source Code</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="http://issues.apache.org/jira/browse/HARMONY">JIRA</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="./related.html">Other Projects</a>
</li>
            
           
                        
                </ul>
            <p class="menuItem"><strong>Subcomponents</strong></p>
        <ul>
                    <li class="menuItem">    <a href="./subcomponents/buildtest/index.html">Build-Test Framework</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="./subcomponents/classlibrary/index.html">Class Library</a>
</li>
            
           
                           <table>
              <tr><td class="menuItem">
                &nbsp;&nbsp;&nbsp;&nbsp;    <a href="./subcomponents/classlibrary/status.html">Status</a>
                </td></tr>
              </table>
                        
                    <li class="menuItem">    <a href="./subcomponents/drlvm/index.html">DRLVM</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="./subcomponents/jchevm/index.html">JCHEVM</a>
</li>
            
           
                        
                </ul>
                        </td>
                    <td width="80%" valign="top"><a name="top"></a>
                                                                    <table  cellspacing="0" cellpadding="2" width="100%">
      <tr><td>
        <h1>
          <a name="Getting Started For Contributors">Getting Started For Contributors</a>
        </h1>
      </td></tr>
      <tr><td>
                                    <p>
            This document explains how to get configured to build and
            work with the Apache Harmony source code.
        </p>
                                                    
      <tr><td>
            <h2>
          <a name="Prerequisites">Prerequisites</a>
            </h2>
      </td></tr>
      <tr><td>
        
                                    <p>
            Basic prequisites for working with Apache Harmony are :
        </p>
                                                <ul>
            <li><a href="http://ant.apache.org/">Apache Ant</a> version 1.6.5 or later</li>
            <li><a href="http://subversion.tigris.org/">Subversion</a></li>
            <li>Java SE 5 JDK</li>
        </ul>
                                                <p>
            The other prerequistes for building Harmony differ by platform :
        </p>
                                                <strong>Linux</strong>
                                                <p>
          The following is the sequence of things you need to do to setup a linux box
          to build Harmony.  The following instructions have been tested on Ubuntu 6, 
          so simply adapt for the package management system on your distro.  There are 
          some repeats of the prereqs listed above
        </p>
                                                <ol>
        <li> Install subversion (ex : $ sudo apt-get install subversion)</li>
        <li> Install gcc (ex. : $ sudo apt-get install gcc)</li>
        <li> Install g++ (ex. : $ sudo apt-get install g++) </li>
        <li> Install make (ex. : $ sudo apt-get install make) </li>
        <li> Install Java (from Sun or BEA or IBM).  Version 1.5.0_9 preferred</li>
        <li> Install binutils (ex : $    apt-get install binutils-dev )</li>
        <li> Get JUnit (http://www.junit.org) and drop the junit-VERSION.jar in $ANT_HOME/lib</li>
        <li> Install dependencies for Swing/AWT : 
            <ul>
               <li>apt-get install liblcms1-dev</li>
			   <li>apt-get install libpng12-dev</li>
		   	   <li>apt-get install libjpeg62-dev</li>
         	   <li>apt-get install libx11-dev</li>
               <li>apt-get install libxft-dev</li>
            </ul>
        </li>
        </ol>
                                                <strong>Windows</strong>
                                                <p>
            <i>Windows deps go here</i>

            <ul>
                <li>
                    Microsoft Visual Studio .NET 2003
                 </li>
            </ul>
        </p>
                                                <p>
            The remaining instructions assume the above are installed on your platform.
        </p>
                            
      </td></tr>
       
                                                    
      <tr><td>
            <h2>
          <a name="Checking out the Federated Build Tree">Checking out the Federated Build Tree</a>
            </h2>
      </td></tr>
      <tr><td>
        
                                    <p>
            The Harmony codebase is divided into many separate parts.  To create a working
            JRE, you'll need the  class library and a virtual machine.  Currently, the
            easiest way to do this is uing the "federated build" tree and then working
            within the class library directory and the VM directory as you choose.
            Currently, the federated build uses the DRLVM virtuaal machine.
        </p>
                                                <p>
            First, checkout the federated build :
        </p>
                                                <pre>
 $ svn co https://svn.apache.org/repos/asf/incubator/harmony/enhanced/trunk
        </pre>
                                                <p>
            This will checkout a directory structure that contains a <code>working_classlib</code>
            directory, which after the next step will be the checkout of the classlib SVN tree
            and <code>working_vm</code>, which after the next step will be the checkout
            of the DRLVM SVN tree.
        </p>
                                                <p>
            Note that if you type "ant" in this directory, you will checkout, build and
            package snapshots of the JRE and HDK.  However, this isn't a convenient
            way to work for a developer, so please continue with the next steps.
        </p>
                            
      </td></tr>
       
                                                    
      <tr><td>
            <h2>
          <a name="Populating the VM and Classlib Source Trees">Populating the VM and Classlib Source Trees</a>
            </h2>
      </td></tr>
      <tr><td>
        
                                    <p>
            The federated build <code>build.xml</code> script contains a useful target
            created to help populate the source trees.  To do so, just do the following in the
            root directory of the federated build :
        </p>
                                                <pre>
$ ant populate_source
         </pre>
                                                <p>
            This will checkout classlib and DRLVM into the working_classlib and working_vm
            directories, respectively, at the same SVN version of the build.xml file.  Please
            note that the source trees are large, and that a checkout can take a very long time.
            Also, not that due to limits of the Windows filesystem, if the root of the
            federated build is multiple levels deep in your filesystem, the very long paths within
            classlibrary might result in a SVN checkout failure on Windows.  The solution is to move the
            tree upwards in your filesystem (or switch operating systems).
        </p>
                                                <p>
            Note
            that at any time going forward, you can bring either directory to current SVN
            revision simply by doing a <code>svn update</code> in either directory.
        </p>
                                                <pre>
$ cd working_classlib
$ svn update
        </pre>
                                                <p>
            These are full, valid checkouts of the classlibrary and DRLVM.  Any modifications
            made to the SVN repository will be reflected in your tree after a <code>svn update</code>.
            If you are a project committer, you can make commits from within this tree - it's
            a normal SVN checkout.
        </p>
                            
      </td></tr>
       
                                                    
      <tr><td>
            <h2>
          <a name="Building the Code">Building the Code</a>
            </h2>
      </td></tr>
      <tr><td>
        
                                    <p>
            Now you should be ready to build the code.  The DRLVM has a dependency on the
            class library and also assembles a working JRE as part of it's build, so you should
            build the classlibrary first.
         </p>
                                                <strong>Building the Class Library</strong>
                                                <p>
            For the first time you build, you'll want to
            fetch all the classlib dependencies.   If you don't, or if in the future a new
            dependency is added, the build will tell you what to do, so you may have to do this
            step periodically.
        </p>
                                                <pre>
$ cd working_classlib
$ ant fetch-depends
$ ant
        </pre>
                                                <p>
            Note that if you are working from behind a firewall, you may need to configure
            ant to use a proxy via the ANT_OPTS environment variable.  For example
        </p>
                                                <pre>
$ export ANT_OPTS='-Dhttp.proxyHost=&lt;proxy.host&gt; -Dhttp.proxyPort=&lt;proxy port&gt;'
        </pre>
                                                <p>
            If the above succeeds, you now have built the Apache Harmony classlibrary, both
            the Java code as well as the native code for your platform.  To run the test suite,
            you will first need a virtual machine.  As the DRLVM isn't yet complete,
            you can use the
            <a href="http://www-128.ibm.com/developerworks/java/jdk/harmony/index.html">
            IBM J9 virtual machine</a> generously made available for the project's development needs
            by IBM under a non-open source, binary evaluation license.  Please install according to
            the instructions that accompany that VM.
        </p>
                                                <p>
            Once you have a VM installed, you can run the tests very easily :
        </p>
                                                <pre>
 $ ant test
        </pre>
                                                <p>
            Which will run the full testsuite for the classlibrary.
        </p>
                                                <strong>Building DRLVM</strong>
                                                <p>
            Now that classlibrary is built, we can build the DRLVM, which will assemble a working
            JRE as well.  To do this, return to the root of the federated build and switch into the
            working_vm directory.  Then switch into DRLVM's build directory.
        </p>
                                                <pre>
 $ cd working_vm
 $ cd build
        </pre>
                                                <p>
            The first thing we have to do is tell the DRLVM build where to find the class library.
            We can do this simply by renaming the file <code>drlvm.properties.example</code> in
            the DRLVM <code>build</code> directory to <code>drlvm.properties</code>.  This file
            containes a property definition that tells DRLVM build to use the classlib in
            <code>working_classlib</code>.  If you need to, you can override this on the command line
            if you want to point to another build of the classlib.
        </p>
                                                <pre>
 $ cp drlvm.properties.example drlvm.properties
        </pre>
                                                <p>
            If you are a windows user, note that you <i>must</i> be working from the Visual
            Studio .NET Command Promt (you'll see it - it's installed with the Visual Studio mentioned
            above).  As of now, you cannot build from a Cygwin or other alternative shell. Also, you
            will need to set the "CXX" environment variable to "msvc" to indicate to the build
            which compiler is being used.  Again, for windows only users :
        </p>
                                                <pre>
 C:...\trunk\working_vm\build&gt; set CXX=msvc
        </pre>
                                                <p>
            Now you are ready to build.  To do so, we first fetch our dependencies.  Please note that this
            can take a long time.  Be patient :
        </p>
                                                <pre>
On Linux :
$ sh build.sh update

On Windows :
C:...\trunk\working_vm\build&gt;build.bat update
        </pre>
                                                <p>
            Once we have obtained our dependencies, we can proceed with the build :
        </p>
                                                <pre>
On Linux :
$ sh build.sh

On Windows :
C:...\trunk\working_vm\build&gt;build.bat
        </pre>
                                                <p>
            and when complete, with the tests :
        </p>
                                                <pre>
On Linux :
$ sh build.sh test

On Windows :
C:...\trunk\working_vm\build&gt;build.bat test
        </pre>
                                                <p>
            Note that the so-called "kernel" tests don't currently pass.  If you get through the
            "C Unit" and "Smoke" tests, you are doing ok.
        </p>
                                                <p>
            At this point, the DRLVM build is complete.  There is a full JRE in the
            <code>deploy/jre</code> subdirectory of the <code>build</code> directory.
            You can simply
        </p>
                                                <pre>
$ cd deploy/jre/bin
$ ./java -version
Apache Harmony Launcher : (c) Copyright 1991, 2006 The Apache Software Foundation or its licensors, as applicable.
java version &quot;1.5.0&quot;
pre-alpha : not complete or compatible
svn = r448280, (Sep 21 2006), Linux/ia32/gcc 3.4.6, debug build
http://incubator.apache.org/harmon
        </pre>
                            
      </td></tr>
       
                                                    
      <tr><td>
            <h2>
          <a name="Using the Built Code">Using the Built Code</a>
            </h2>
      </td></tr>
      <tr><td>
        
                                    <p>
            There are two ways developers use the code.  Class library developers tend
            to install the IBM J9 VM in the <code>working_classlib/deploy/jdk/jre</code>
            so they can use it as a "known good" VM for unit testing.  DRLVM developers
            tend to work with the result of the DRLVM build step, which is a JRE
            containing the DRLVM and the class library.
        </p>
                                                <p>
            To work with the classlibrary, please continue with the material found
            in our <a href="subcomponents/classlibrary/index.html">classlibrary subcomponent</a>.
        </p>
                                                <p>
            To work with the DRLVM, you can simple set JAVA_HOME to the <code>deploy/jre</code>
        </p>
                            
      </td></tr>
       
                           
      </td></tr>
    </table>
    <p><a href="#top">Back to top</a></p>
                    
                                                            </td>
                </tr>

                <!-- FOOTER -->
                <tr><td colspan="2">
                    <hr noshade="" size="1"/>
                </td></tr>
                <tr><td colspan="2">
                    <div class="special"><em>
                    Copyright &#169; 2003-2006, The Apache Software Foundation
                    </em></div>
                </td></tr>
            </table>
        </body>
    </html>
<!-- end the processing -->






















