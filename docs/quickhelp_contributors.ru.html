<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<!--
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements. See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to You under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License. You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->


<!-- start the processing -->
    <!-- ====================================================================== -->
    <!-- GENERATED FILE, DO NOT EDIT, EDIT THE XML FILE IN xdocs INSTEAD! -->
    <!-- Main Page Section -->
    <!-- ====================================================================== -->
    <html>
        <head>
            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

                                                    <meta name="author" value="Harmony Documentation Team">
            <meta name="email" value="dev@harmony.apache.org">
            
           
            
            
            
            
            
            <title>Apache Harmony - Open Source Java SE</title>

                        
                
        <link rel="stylesheet" type="text/css" href="css/site.css" media="all" />
        <link rel="stylesheet" type="text/css" href="css/screen.css" media="screen" />
        <link rel="stylesheet" type="text/css" href="css/print.css" media="print" />

                        
        </head>

        <body>
            <div id="pageHeader">
            <!-- Logo -->
                        <a id="harmonyLogo" href="http://harmony.apache.org/"><img src="./images/harmony-logo-new.png" alt="Apache Harmony"
          width="415" height="50" /></a>
      
            <!-- Advertisement -->
            <a href="http://eu.apachecon.com">
                <img id="advertisement"
                     src="http://eu.apachecon.com/eu2008/images/buttons/basic_234x60.jpg"
                     width="234" height="60"
                     alt="ApacheCon Europe 2008" /></a>
            </div> <!-- pageHeader -->

            <div id="navigationmenu">
                    <!-- LEFT SIDE NAVIGATION -->
                
    <!-- ============================================================ -->

                <p class="menuItem">Основные ссылки</p>
        <ul>
                    <li class="menuItem">    <a href="./index.ru.html">Главная страница</a>
</li>
           
                        
                    <li class="menuItem">    <a href="./license.html">License</a>
</li>
           
                        
                    <li class="menuItem">    <a href="./contribution_policy.html">Contribution Policy</a>
</li>
           
                        
                    <li class="menuItem">    <a href="./download.cgi">Downloads</a>
</li>
           
                        
                    <li class="menuItem">    <a href="./bundles.ru.html">Готовые решения ПО</a>
</li>
           
                        
                    <li class="menuItem">    <a href="./faq.html">FAQ</a>
</li>
           
                        
                    <li class="menuItem">    <a href="./sitemap.html">Sitemap</a>
</li>
           
                        
        
        </ul>
            <p class="menuItem">Сообщество</p>
        <ul>
                    <li class="menuItem">    <a href="./get-involved.html">Get Involved</a>
</li>
           
                        
                    <li class="menuItem">    <a href="./contributors.html">Who we are</a>
</li>
           
                        
                    <li class="menuItem">    <a href="./mailing.html">Mailing Lists</a>
</li>
           
                        
                    <li class="menuItem">    <a href="http://issues.apache.org/jira/browse/HARMONY">Bug Tracker</a>
</li>
           
                        
                    <li class="menuItem">    <a href="./related.html">Other Projects</a>
</li>
           
                        
        
        </ul>
            <p class="menuItem">Развитие проекта</p>
        <ul>
                    <li class="menuItem">    <a href="./svn.html">Source Code</a>
</li>
           
                        
                    <li class="menuItem">    <a href="./quickhelp_contributors.ru.html">Инструкция разработчика</a>
</li>
           
                        
                    <li class="menuItem">    <a href="./roadmap.html">Project Roadmap</a>
</li>
           
                        
                    <li class="menuItem">    <a href="./issue_resolution_guideline.html">Resolution Guideline</a>
</li>
           
                        
                    <li class="menuItem">    <a href="./performance.html">Performance</a>
</li>
           
                        
        
        </ul>
            <p class="menuItem">Документация</p>
        <ul>
                    <li class="menuItem">    <a href="http://www.jdocs.com/harmony/5.M5/overview-summary.html">API Reference</a>
</li>
           
                        
                    <li class="menuItem">    <a href="http://wiki.apache.org/harmony">Wiki</a>
</li>
           
                        
                    <li class="menuItem">    <a href="./subcomponents/drlvm/index.html">DRLVM</a>
</li>
           
                        
                    <li class="menuItem">    <a href="./subcomponents/classlibrary/index.html">Class Library</a>
</li>
           
                        
                    <li class="menuItem">    <a href="./subcomponents/buildtest/index.html">Build-test Framework</a>
</li>
           
                        
        
        </ul>
            <p class="menuItem">Организация Апачи</p>
        <ul>
                    <li class="menuItem">    <a href="http://apache.org">ASF</a>
</li>
           
                        
                    <li class="menuItem">    <a href="http://www.apache.org/foundation/sponsorship.html ">Sponsorship</a>
</li>
           
                        
                    <li class="menuItem">    <a href="http://www.apache.org/foundation/thanks.html ">Thanks</a>
</li>
           
                        
        
        </ul>
                </div>

            <!-- MAIN CONTENT -->
            <div id="top">
                                                        <h1>
      <a name="Инструкция по сборке и использованию исходного кода Apache Harmony">Инструкция по сборке и использованию исходного кода Apache Harmony</a>
    </h1>
                        <p style="text-align: right">RU | <a href="quickhelp_contributors.html">EN</a></p>
                                <p>Следуйте этой инструкции, чтобы настроить, скомпилировать и работать с исходным 
    кодом Apache Harmony. Для этого, необходимо: </p>
                                <ol type="1">
       <li><a href="#prerequisites">Убедиться, что установлено все необходимое ПО</a>.  </li>
       <li><a href="#checkout">Получить (скачать) исходный код</a>. </li>
       <li><a href="#building">Скомпилировать исходный код</a>.
    </li>
    </ol>
                                <p>После успешной сборки, вы сможете <a href="#running-harmony">запускать Java приложения</a>
    , используя Harmony. </p>
                                <p>Если вам не нужен весь комплект разработчика Harmony Java SE (HDK),
    и вы намерены работать с отдельными частями кода Apache Harmony, следуйте
    <a href="#step-by-step">пошаговой инструкции</a> для построения
    отдельных компонент этого комплекта.  </p>
                                <p>Проект находится на стадии разработки. При обнаружении ошибок,
    воспользуйтесь поиском по архиву <a href="mailing.html">
    почтовой рассылки проекта</a> - возможно, ваша проблема уже выявлена и решена.
    Если вы не нашли нужную информацию, пришлите нам описание проблемы, и мы постараемся помочь.  </p>
                                    
    <h2>
        <a name="1. Требования к системе">1. Требования к системе</a>
    </h2>
      
                        <a id="prerequisites" />
                                <h3>Общие требования</h3>
                                <p>Для работы с Harmony необходимо установить следующее ПО: </p>
                                <ul>
        <li> Apache Ant версия 1.6.5 или более поздняя
        </li>
        <li> Subversion
        </li>
        <li> Java SE 5 JDK
        <p><strong>Примечание:</strong> если у вас включен брандмауэр,
        настройте соединение через прокси-сервер для работы с ant и svn.
        Для svn, следуйте указаниям в документации клиентского приложения.
        Например, для использования консольной версии svn внесите
        соответствующие изменения в файл <code>~/.subversion/servers</code>.
        Для работы ant, укажите следующие значения  для переменной окружения
        <code>ANT_OPTS</code>:
        </p>
        <pre>-Dhttp.proxyHost=&lt;host&gt;
-Dhttp.proxyPort=&lt;proxy&gt;</pre>
        </li>
        </ul>
                                <p>Необязательным (но рекомендкемым) ПО является Eclipse Java Compiler (ECJ), 
      версия 3.2 или более поздняя. 
      Вы можете <a href="http://download.eclipse.org/eclipse/downloads/">скачать</a> 
      ecj.jar как отдельный файл и поместить его в папку <code>ANT_HOME/lib</code>.
      В качестве альтернативы, вы можете использовать любой другой компилятор для 
      Java 1.5, совместимый с Ant, посредством переопределения переменной
      <code>hy.javac.compiler</code>.
      </p>
                                <h3>Tребования для отдельных платформ</h3>
                                <p>В зависимости от платформы (см. <a href="roadmap.html#Porting Matrix">
    список поддерживаемых платформ</a>) вам понадобится ряд 
    других программ, наиболее общий список которых приводится ниже.  </p>
                                <p><strong>Windows</strong> </p>
                                <ul>
               <li> SDK для платформы Windows </li>
               <li> Microsoft Visual Studio.NET 2003 </li>
               <li> (по желанию) Внешний компилятор:
                <ul>
                    <li> Microsoft 32-битный компилятор C/C++, версия 7 или более поздняя </li>
                    <li> Intel C++ Compiler , версия 9.0 </li>
                </ul></li>
            </ul>
                                <p><strong>Linux</strong> </p>
                                <ul>
        <li> gcc компилятор, версия 3.3.3 или более поздняя (Версии до 3.3.3 не тестировались но могут работать.) </li>
        <li> g++ компилятор </li>
        <li> make </li>
        <li> liblcms1-dev </li>
        <li> libpng12-dev </li>
        <li> libjpeg62-dev </li>
        <li> libx11-dev </li>
        <li> libxft-dev </li>
        <li> binutils-dev </li>
        <li> libxml2-dev </li>
        <li> x11proto-xext-dev </li>
    </ul>
                                <p class="note">Примечание:</p>
                                <p class="notetext">
      Вам необходимо убедиться, что вы правильно настроили своё окружение для работы с 
      указанными выше программами. В частности, переменные окружения (такие как PATH)
      содержат все необходимые файловые пути и т.д., так что вы можете успешно работать
      со всеми инструментами из командной строки. <br />
      Например, для использования C++ компилятора на Windows, как правило, потребуется
      запустить соответствующий скрипт (такой как  
      "Visual Studio .NET 2003 Command Prompt") непосредственно перед началом сборки.
      </p>
                                <h3>Дополнительные требования</h3>
                                <p>Отдельные компоненты системы сборки также зависит от сторонних программных продуктов и библиотек. 
    Поскольку эти требования постоянно эволюционируют, мы рекомендуем запустить систему сборки и 
    автоматически загрузить недостающие компоненты через Интернет.  </p>
                                <p>Для построения виртуальной машины DRLVM, одного из основных компонентов системы, требуются: </p>
                                <ul>
        <li> Cpp Tasks collection, версия 1.0 beta 3 или более поздняя (загружается из сети)  </li>
        <li> библиотека Zlib, бинарные файлы, версия 1.2.1 или более поздняя (загружается из сети)  </li>
        <li> Apache Portable Runtime Layer , версия 1.2.6 (загружается из сети)  </li>
        <li> APR-util, версия 1.2.6 (загружается из сети)  </li>
        <li> APR-iconv, версия 1.1.1 (загружается из сети) </li>
        <li> Log4cxx , наиболее поздняя версия, из SVN - 467164 (загружается из сети)  </li>
    </ul>
                                <p>Данные компоненты необходимы для построения исходного кода как на Windows, так и на Linux системах. </p>
                                <p>Вы можете загрузить и установить дополнительные компоненты до сборки DRLVM и указать их расположение 
    (например отредактировав файл <code>make/depends.properties</code> в рабочем пространстве компоненты).
    Однако, поскольку требования к ПО периодически изменяются, не рекомендуется самостоятельно устанавливать 
    недостающие программы. Система сборки сделает это за вас.  </p>
                   
                                    
    <h2>
        <a name="2. Загрузка федеративной систему сборки">2. Загрузка федеративной систему сборки</a>
    </h2>
      
                        <a id="checkout" />
                                <p>ПО Harmony разделено на несколько компонент. Для построения всего ПО вам 
        необходимо построить библиотеку классов, виртуальную машину и инструменты Java разработчика. 
        Используйте федеративную систему сборки для построения всей среды, а затем работайте с библиотекой 
        классов и/или ВМ по вашему выбору. В настоящее время, система сборки использует виртуальную машину 
        DRLVM. </p>
                                <p>Для того, чтобы загрузить федеративную систему сборки из SVN репозитория, используйте 
        следующую команду:
        </p>
                                <pre>$ svn co http://svn.apache.org/repos/asf/harmony/enhanced/trunk</pre>
                                <p>Данная команда создаст дерево каталогов с пустыми директориями <code>common_resources</code>,
        <code>working_classlib</code>, 
        <code>working_vm</code> и <code>working_jdktools</code>. После загрузки исходного кода 
        на следующем этапе, директория <code>working_classlib</code> будет содержать копию дерева 
        каталогов библиотеки классов, директория <code>working_vm</code> - копию дерева каталогов DRLVM, 
        и так далее. </p>
                                <p><strong>Примечание</strong>: в ОС Windows, если корневая директория системы сборки находится 
    на много уровней ниже корневого каталога, излишне длинный путь к библиотеке классов может вызвать 
    ошибку при попытке загрузить исходный код. Для решения этой проблемы, переместите корневую директорию 
    системы сборки выше по дереву каталогов или смените операционную систему.  </p>
                   
                                    
    <h2>
        <a name="3. Использование федеративной систему сборки">3. Использование федеративной систему сборки</a>
    </h2>
      
                        <a id="building" />
                                <p> На этом этапе система готова начать сборку. Во время первого запуска системы потребуется загрузка 
    всех необходимых внешних компонент. Система сборки оповещает пользователя об отсутствии необходимых 
    компонент или изменении в требованиях, так что процедуру загрузки внешних компонент необходимо 
    будет периодически повторять.  </p>
                                <p>Для того, чтобы загрузить необходимые сторонние компоненты, исходные тексты Harmony и построить 
    готовую среду исполнения и комплекты разработчика Harmony Java SE (JRE, JDK и HDK), в корневой папке 
    системы сборки вызовите следующую команду:
    </p>
                                <pre>$ ant -Dauto.fetch=true</pre>
                                <p>Данная команда загружает сторонние компоненты, которые могут распространяться под различными 
    лицензиями, отличающимися от лицензии Apache, см. полный список лицензий в файле 
    <code>THIRD_PARTY_NOTICES.txt</code> в корневой папке.  </p>
                                <p>Скачивать дополнительные компоненты потребуется только во время первого прогона сборки. 
    Для последующих прогонов, достаточно использовать команду
    </p>
                                <pre>$ ant</pre>
                                <p> Для построения полной сборки рекомендуется увеличить объем динамической памяти (Java heap), 
    используемой программой Apache Ant. Для этого, измените значение переменной окружения ANT_OPTS 
    доступным для вашей операционной системы способом, например:
    </p>
                                <pre>ANT_OPTS='-Xms256m -Xmx512m' </pre>
                                <p>Если вы предполагаете использовать только отдельные части исходного кода, вам не обязательно 
    строить весь комплект 
    разработчика. В таком случае, не вызывайте ant и следуйте пошаговой инструкции как указано ниже.  
    </p>
                   
                <p class="backtotop"><a href="#top">Back to top</a></p>
                                        <h1>
      <a name="Пошаговая инструкция сборки отдельных компонент">Пошаговая инструкция сборки отдельных компонент</a>
    </h1>
                            
    <h2>
        <a name="1. Извлечение дерева каталогов">1. Извлечение дерева каталогов</a>
    </h2>
      
                        <a id="step-by-step" />
                                <p>Для извлечения полного дерева каталогов для всех компонент, удобно использовать скрипт 
    <code>build.xml</code> федеративной системы сборки. В корневой директории системы сборки, 
    выполните следующую команду:
    </p>
                                <pre>$ ant populate-src</pre>
                                <p>Данная команда скачивает из SVN репозитория исходные тексты библиотек классов, 
    ВМ и утилит в директории <code>working_classlib</code>,
    <code>working_vm</code> и <code>working_jdktools</code> соответственно, 
    причем версия извлеченного кода соответствует версии файла <code>build.xml</code>. 
    Поскольку дерево каталогов довольно велико, загрузка всех каталогов может занять продолжительное время.  </p>
                                <p>
    При желании, вы можете сэкономить время и сетевые ресурсы, скачав только интересующие вас компоненты вручную. 
    В таком случае, для сборки вам дополнительно потребуется готовый пакет разработчика 
      <a href="hdk.html">HDK</a>, который вы можете скачать с сайта Apache Harmony.
    </p>
                   
                                    
    <h2>
        <a name="2. Обновление Дерева Каталогов">2. Обновление Дерева Каталогов</a>
    </h2>
      
                        <p>По прошествии времени, вы можете синхронизировать вашу копию исходного кода с текущей версией 
    в SVN репозитории, вызывая команду <code>svn update</code> в нужной директории, например:
    </p>
                                <pre>$ cd working_classlib
$ svn update</pre>
                                <p>Таким способом вы можете получать обновления кода любого из компонент. 
    После исполнения команды в вашем дереве каталогов отобразятся все изменения, внесенные в 
    SVN репозиторий после предыдущей синхронизации. 
    </p>
                                <p class="note">Примечание:</p>
                                <p class="notetext">
    если после обновления дерева каталогов появляется ошибка при построении библиотеки классов, 
    удалите результаты предыдущей сборки командой
    </p>
                                <pre>$ ant clean</pre>
                   
                                    
    <h2>
        <a name="3. Сборка компонентов">3. Сборка компонентов</a>
    </h2>
      
                        <p>На данном этапе система готова скомпилировать исходный код. Необходимо собирать компоненты в 
    следующем порядке: сперва библиотеку классов, затем ВМ, затем утилиты. Это важно, поскольку между 
    компонентами существуют зависимости, каждая последующая компонента использует результаты сборки
    предыдущей.
    </p>
                                <p>
    Все компоненты имеют унифицированные интерфейсы к системам сборки, т.е. они поддерживают
    одинаковый базовый набор команд и переменных. Поэтому последующие шаги даются на примере
    библиотеки классов, но применимы ко всем другим компонентам.
  </p>
                                <p>Во время первой сборки система загружает все необходимые сторонние компоненты. 
    Система сборки оповещает пользователя об отсутствии необходимых компонент или изменении в требованиях, 
    так что процедуру загрузки внешних компонент потребуется периодически повторять.  </p>
                                <p>Для загрузки внешних компонент и сборки библиотеки классов используйте следующие команды:
    </p>
                                <pre>$ cd working_classlib
$ ant fetch-depends
$ ant</pre>
                                <p> Теперь вы можете протестировать результаты сборки. Каждая компоненты включает
    достаточно полный набор тестов на функциональность и должна успешно выполнять 100% из них.
    Примечание: для тестирования библиотеки классов вам необходима виртуальная машина. 
    Вы можете использовать не только DRLVM, см. раздел 
    <a href="#assemble-jdk">Конструирование среды исполнения</a>. 
    Если вы хотите тестировать библиотеку классов вместе с DRLVM, приступайте к сборке DRLVM.<br />
    Выполните следующую команду для построения и прогона полного набора тестов:
    </p>
                                <pre>$ ant test</pre>
                                <p>
    Сборка завершена. Результаты сборки для каждого компонента находятся 
    в директории <code>deploy/jdk/jre</code> внутри соответствующего рабочего пространства.
    </p>
                                <p class="note">Примечание</p>
                                <p class="notetext">
      DRLVM создаёт директорию deploy только если переменная <code>deploy.canonical.flag</code> 
      была выставлена в значение <code>TRUE</code>. В противном случае результаты сборки
      расположены глубже по дереву каталогов как <code>build/&lt;ваша-платформа&gt;/deploy/jdk/jre</code>.
    </p>
                                <p> 
     Вы можете получить дополнительную информацию о доступных командах и опциях для 
     каждого из компонент при помощи команды:
    </p>
                                <pre>$ ant help</pre>
                   
                                    
    <h2>
        <a name="5. Конструирование среды исполнения из скомпилированных компонент">5. Конструирование среды исполнения из скомпилированных компонент</a>
    </h2>
      
                        <a id="assemble-jdk" />
                                <p>Разработчики библиотек классов могут использовать виртуальную машину DRLVM
    или установить другую совместимую ВМ. Например, вы можете использовать IBM
    virtual machine которая была предоставлена компанией IBM для нужд разработчиков
     проекта на условиях пробной, не открытой лицензии на выполняемый код.
     Для установки ВМ следуйте прилагающейся документации. Вы можете развернуть
     дерево каталогов библиотек классов поверх дерева каталогов Harmony,
     так что директории 'jdk' совпадут.  </p>
                                <p><strong>Windows</strong>: </p>
                                <pre>$ unzip &lt;path_to_vm_zip&gt; -d ../..</pre>
                                <p><strong>Linux</strong>: </p>
                                <pre>$ tar xzf &lt;path_to_vm_tarball&gt; --directory ../..</pre>
                                <p>Для работы с библиотекой классов Harmony, используйте подробную
    <a href="subcomponents/classlibrary/index.html">документацию</a> для этого компонента. 
    </p>
                                <p> Разработчики виртуальной машины
    DRLVM могут пользоваться результатами сборки DRLVM напрямую, они включают в себя полную 
    среду исполнения Java, состоящую из DRLVM и библиотеки классов.  </p>
                   
                <p class="backtotop"><a href="#top">Back to top</a></p>
                                        <h1>
      <a name="Запуск Java-приложений">Запуск Java-приложений</a>
    </h1>
                        <a id="running-harmony" />
                                <p>Убедитесь, что переменная окружения <code>JAVA_HOME</code> не имеет
значения или указывает на директорию сборки Harmony 
(<code>deploy/jdk/jre</code> если вы собирали по этой инструкции).</p>
                                <p>Используйте стандартный синтаксис для запуска Java-приложений: </p>
                                <pre>
$ deploy/jdk/jre/bin/java -showversion -jar helloworld.jar
Apache Harmony Launcher:
(c) Copyright 1991, 2006 The Apache Software Foundation or its licensors, as applicable.
java version "1.5.0"
pre-alpha : not complete or compatible
svn = r479551, (Nov 27 2006), Windows/ia32/msvc 1310, debug build
http://harmony.apache.org
Hello world!
</pre>
                <p class="backtotop"><a href="#top">Back to top</a></p>
                
                                            </div> <!-- top aka Main Content -->

            <!-- FOOTER -->
            <div id="pageFooter" class="special"><em>
                Copyright &#169; 2003-2008, The Apache Software Foundation
            </em></div>

            <!-- Google analytics tracker code -->
            <script
                src="http://www.google-analytics.com/urchin.js"
                type="text/javascript" />
            <script type="text/javascript">
              _uacct = "UA-1973333-3";
              urchinTracker();
            </script>
        </body>
    </html>
<!-- end the processing -->


















