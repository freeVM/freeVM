<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<!--
Copyright 1999-2004 The Apache Software Foundation
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->


<!-- start the processing -->
    <!-- ====================================================================== -->
    <!-- GENERATED FILE, DO NOT EDIT, EDIT THE XML FILE IN xdocs INSTEAD! -->
    <!-- Main Page Section -->
    <!-- ====================================================================== -->
    <html>
        <head>
            <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>

                                                    <meta name="author" value="Harmony Documentation Team">
            <meta name="email" value="harmony-dev@incubator.apache.org">
            
           
            
            
            
            
            
            <title>Apache Harmony - Compatibility goals in the Apache Harmony Classlib</title>

                                <link rel="Stylesheet" type="text/css" href="/harmony/site.css"/>
        </head>

        <body>        
            <table  width="100%" cellspacing="0">
                <!-- TOP IMAGE -->
                <tr>
                    <td align='LEFT'>
                    <table><tr><td>
                    <td>
<a href="http://incubator.apache.org/harmony/"><img  src="../../images/harmony-logo.png" alt="Apache Harmony" /></a>
</td>
</td>
                    </td></tr></table>
                    </td>
                    <td align='RIGHT'>
                    <a href="http://incubator.apache.org/harmony/">
                    <img src="http://incubator.apache.org/harmony/images/apache-incubator-logo.png"
                    	alt="Apache Harmony" /></a>                    
                    </td>
                </tr>
            </table>
            <table width="100%" cellspacing="4">
                <tr><td colspan="2">
                    <hr noshade="" size="1"/>
                </td></tr>

                <tr>
                    <!-- LEFT SIDE NAVIGATION -->
                    <td class="menuItem" width="20%" nowrap="true">

                    <!-- special ACon Logo - leave here for next time -->
                    <a href="http://www.us.apachecon.com/">
                        <img src="http://www.apache.org/ads/ApacheCon/240x120-2006-us.gif"
                             alt="ApacheCon US 2006" />
                    </a>

                   <!-- regular menu -->

                    
    <!-- ============================================================ -->

                <p class="menuItem"><strong>General</strong></p>
        <ul>
                    <li class="menuItem">    <a href="../../index.html">Home</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="../../license.html">License</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="../../contribution_policy.html">Contribution Policy</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="../../guidelines.html">Project Guidelines</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="http://www.apache.org/">ASF</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="../../downloads.html">Downloads</a>
</li>
            
           
                        
                </ul>
            <p class="menuItem"><strong>Community</strong></p>
        <ul>
                    <li class="menuItem">    <a href="../../get-involved.html">Get Involved</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="../../contributors.html">Committers</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="../../mailing.html">Mailing Lists</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="../../documentation/documentation.html">Documentation</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="../../faq.html">FAQ</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="http://wiki.apache.org/harmony">Wiki</a>
</li>
            
           
                        
                </ul>
            <p class="menuItem"><strong>Development</strong></p>
        <ul>
                    <li class="menuItem">    <a href="../../status.html">How Are We Doing?</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="../../roadmap.html">Road Map / TODO</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="../../svn.html">Source Code</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="http://issues.apache.org/jira/browse/HARMONY">JIRA</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="../../related.html">Other Projects</a>
</li>
            
           
                        
                </ul>
            <p class="menuItem"><strong>Subcomponents</strong></p>
        <ul>
                    <li class="menuItem">    <a href="../../subcomponents/buildtest/index.html">Build-Test Framework</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="../../subcomponents/classlibrary/index.html">Class Library</a>
</li>
            
           
                           <table>
              <tr><td class="menuItem">
                &nbsp;&nbsp;&nbsp;&nbsp;    <a href="../../subcomponents/classlibrary/status.html">Status</a>
                </td></tr>
              </table>
                        
                    <li class="menuItem">    <a href="../../subcomponents/drlvm/index.html">DRLVM</a>
</li>
            
           
                        
                    <li class="menuItem">    <a href="../../subcomponents/jchevm/index.html">JCHEVM</a>
</li>
            
           
                        
                </ul>
                        </td>
                    <td width="80%" valign="top"><a name="top"></a>
                                                                    <table  cellspacing="0" cellpadding="2" width="100%">
      <tr><td>
        <h1>
          <a name="Compatibility goals in the Apache Harmony Class Library">Compatibility goals in the Apache Harmony Class Library</a>
        </h1>
      </td></tr>
      <tr><td>
                                    <p>
		<big><em>The following guidelines are currently PROPOSED and being discussed on the
		development mailing list <code>harmony-dev@incubator.apache.org</code>.  Please
		direct comments and questions there.</em></big>
	</p>
                                                <p>
		The Harmony project class library ("<b>classlib</b>") effort is committed
		to producing a set of class library code that not only Java compliant but is also
		compatible with existing Java implementations.
		This page describes the class library code guidelines for ensuring that compatibility.
	</p>
                                                    
      <tr><td>
            <h2>
          <a name="The "Reference Implementation"">The "Reference Implementation"</a>
            </h2>
      </td></tr>
      <tr><td>
        
                                    <a name="referenceImpl" />
                                                <p>
		The Harmony project
		'<a href="http://incubator.apache.org/harmony/subcomponents/classlibrary">classlib</a>'
		effort is producing a set of class library code that is compatible with
		<a href="http://java.sun.com/j2se/1.5.0/docs/api/index.html">the Java SE 5.0 API
		specification</a>.
	</p>
                                                <p>
		At times (discussed below) it is necessary to augment the specification based on the
		behavior of the reference implementation (RI) of the Java SE 5.0 specification.  In
		such cases we use <a href="http://java.sun.com/j2se/1.5.0/download.jsp">the latest
		official release of the Java SE 5.0 RI</a>.
	</p>
                                                <p>
		We are aware that there are other compliant implementations of Java 5.0 available
		but there is only one reference implementation of the Java specification.
	</p>
                            
      </td></tr>
       
                                                    
      <tr><td>
            <h2>
          <a name="General Compatibility Guidelines">General Compatibility Guidelines</a>
            </h2>
      </td></tr>
      <tr><td>
        
                                    <p>
		The following general guidelines apply when developing class library code for Apache
		Harmony:
		<ul>
			<li><b>Comply with the Java Specification</b>
			<p>
				In the first instance we follow the description of each part of the class
				library given in the <a href="#referenceImpl">Java specification</a>.  To
				the large part, this adequately describes the behavior of the class library
				implementation including methods, exceptions, and serialization.  However,
				where the specification is silent on a particular issue facing the implementor,
				or the described behavior is clearly illogical, then we follow the behavior
				of the reference implementation.
			</p></li>
			<li><b>Follow the Reference Implementation</b>
			<p>
				The Reference Implementation (RI) is used to resolve issues that are not
				adequately addressed in the specification.  In such cases we use the RI as a
				guide to the compliant and expected behavior; however, developers <em>must</em>
				ensure that the behaviour of the RI is determined soley through exercising the
				public Java APIs -- specifically we avoid any notion of reverse engineering or
				exposition of the RI's implementation by exercising non-API types and methods.
				</p>
				<p>
				There are a few occasions where both the specification is quiet on a given
				issue, and the RI exhibits behaviour that we would consider illogical.  In such
				cases we discuss the issue on
				<a href="http://incubator.apache.org/harmony/mailing.html">the Harmony developers'
				mailing list</a>, and code the class libraries to do what the development community
				conclude is "the logical thing".
			</p></li>
			<li><b>Do "the Logical Thing"</b>
			<p>
				The final decision about how a piece of code should behave, on those rare occasions
				where the specification and RI do not provide a satisfactory answer, is reached
				by concensus on the Harmony developers' mailing list.  Each issue is debated based
				on it's individual circumstances, but the developers are aware that breaking popular
				applications is invariably not "the logical thing" to do.
				<p>
				</p>
				Once a decision has been made it is documented in the code comments and an issue
				raised in <a href="http://issues.apache.org/jira/browse/HARMONY">the Harmony JIRA issue
				tracking system</a> to record the conclusion.  It should be noted that very few issues
				need to be resolved this way.
			</p></li>
		</ul>
	</p>
                            
      </td></tr>
       
                                                    
      <tr><td>
            <h2>
          <a name="Exception-throwing compatibility">Exception-throwing compatibility</a>
            </h2>
      </td></tr>
      <tr><td>
        
                                    <p>
		There are a number of methods in the Java specification that describe the conditions under
		which exceptions are thrown.  However, in most cases the specification does not describe all possible
		exceptions that may be thrown, the order of exception throwing (i.e. where there are multiple
		conditions that would result in an exception), and so on.
	</p>
                                                <p>
		The Harmony class libary code aims to be fully compatible with the Reference Implementation (RI)
		of the Java Specification by matching the exception characteristics of each method.
	</p>
                                                <p>
		Harmony
		<b>classlib</b> developers write test cases that deliberately cause exceptions to be thrown
		so that we can match exception behaviour like-for-like.  Harmony class library code should
		throw exceptions of the same runtime class (or a subtype of that runtime class) as the RI, other than
        in cases where the RI throws non-public types whereupon Harmony will throw an exception with the same public supertype.
	</p>
                            
      </td></tr>
       
                                                    
      <tr><td>
            <h2>
          <a name="Serialization compatibility">Serialization compatibility</a>
            </h2>
      </td></tr>
      <tr><td>
        
                                    <p>
		The Harmony class library code aims to be serialization compatible with the reference
		implementation (RI).
	</p>
                                                <p>
		The Java Specification describes the serialized form of many Java types.  Where given, <b>classlib</b> will follow
		the specified serialized form.  When the serialized form is <u>not</u> given we will ensure that the
		serialization data is compatible with the RI by ensuring that objects serialized from the RI
		can be read by Harmony's <b>classlib</b> code, and vice versa.
	</p>
                                                <p>
		Serialization tests are part
		of our regular test suite and typically rely on having the persistent form of serialized objects
		written from the RI stored alongside our test suite code.
	</p>
                                                <p>
		To indicate that we are serialization-compatible we define an explicit Stream Unique Identifier
		(SUID) in each of the Harmony <b>classlib</b> serializable types that is equal to the SUID of
		the corresponding type in the RI.
	</p>
                                                <p>
		Where the RI produces a serialized form that cannot be replicated by Harmony (e.g. the RI serialized
		form includes types that are not part of the Java specification) then Harmony cannot be
		serialization compatible with the RI, and will both make a prominent note of such in the relevant
		type's JavaDoc comment, and raise a JIRA issue that describes the incompatibility.
	</p>
                            
      </td></tr>
       
                           
      </td></tr>
    </table>
    <p><a href="top">Back to top</a></p>
                    
                                                            </td>
                </tr>

                <!-- FOOTER -->
                <tr><td colspan="2">
                    <hr noshade="" size="1"/>
                </td></tr>
                <tr><td colspan="2">
                    <div class="special"><em>
                    Copyright &#169; 2003-2006, The Apache Software Foundation
                    </em></div>
                </td></tr>
            </table>
        </body>
    </html>
<!-- end the processing -->






















