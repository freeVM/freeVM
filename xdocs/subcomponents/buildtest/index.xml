<?xml version="1.0" encoding="ISO-8859-1"?>
<!--

    Copyright 2006 The Apache Software Foundation

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->

<document>

 <properties>
  <title>Apache Harmony</title>
  <author email="harmony-dev@incubator.apache.org">Harmony Documentation Team</author>
 </properties>

 <body>

<section name="Build-Test Framework">
<p>
    The
    <a href="http://svn.apache.org/viewvc/incubator/harmony/enhanced/buildtest/">
    'build-test framework'</a> is a simple configuration of
    <a href="http://cruisecontrol.sourceforge.net/">Cruise Control</a>,
    a framework for continuous build process.  It also includes all the
    necessary support to simplify installation.
</p>

<p>
    Currently, the framework does these distinct tasks, in order :
</p>

    <ol>
        <li>Update the source for the class library from SVN</li>
        <li>Get any new dependencies needed for building the class library</li>
        <li>Build and test the class library</li>
        <li>Update the source for the DRLVM from SVN</li>
        <li>Get and build any new dependencies needed for DRLVM</li>
        <li>Build and test the DRLVM</li>
    </ol>

    <p>
        It does these tasks in-order, and only when code changes in the repository.
    </p>
 </section>

<section name="Setup and Configuration">

    <strong>Pre-requisites</strong>

    <p>
    Basically, you need the tools needed to build the Apache Harmony
    components, like Java, Ant, C/C++ compilers, etc.  Please see
    the other parts of the project for information on the necessary
    toolchains.  You need the following software installed :
    </p>

    <ol>
        <li>Java JDK v5</li>
        <li><a href="http://ant.apache.org/">Apache Ant</a></li>
        <li><a href="http;//subversion.tigris.org/">Subversion Client</a></li>
    </ol>

    <strong>Setup</strong>

    <p>
       Get the /harmony/enhanced/buildtest/ part of the Apache
       Harmony project.  If you are reading this, you either have
       it via a zip or tgz, or have checked it out from the project
       Subversion repository.  In the event that you don't have it
       you can get it via subversion :
    </p>

    <blockquote>
         svn co https://svn.apache.org/repos/asf/incubator/harmony/enhanced/buildtest/trunk
    </blockquote>

    <p>
       With Java, Ant and SVN installed, change into the buildtest/trunk
       directory and type
    </p>

    <blockquote>
          ant setup
    </blockquote>

    <p>
       This should fetch CruiseControl, set it up with the Apache Harmony
       configuration, and checkout the software to be built and tested
       from Apache Harmony.
    </p>

    <p>
       If you wish to have the tests run successfully, you need to do the
       following manual steps for now :
    </p>

    <ol>
      <li>
         build the classlib to create the deploy/jdk tree in classlib, first
         fetching the dependencies
        <blockquote>
           cd cc/projects/classlib/trunk
           ant fetch-depends
           ant
        </blockquote>
      </li>
      <li>
         get the appropriate IBM J9 VM for your platform (this will go
         away when DRLVM is good enough

         <blockquote>
           http://www-128.ibm.com/developerworks/java/jdk/harmony/index.html
         </blockquote>
       </li>

        <li>
         unpack the above-fetched J9 distribution into the jdk directory (as
         the distro assumes it's dropped into the jdk directory...)

        <blockquote>
           cd cc/projects/classlib/trunk/deploy/jdk/
           tar zxf Harmony-vme-linux.IA32-v3.tar.gz
        </blockquote>
        </li>

    </ol>

    <strong>Starting CruiseControl</strong>

    <p>
        To start the system, just type :
    </p>

     <blockquote>
         ant
     </blockquote>

    <p>
       in buildtest/trunk and that will launch CC with the full test set.
       To check status, point your browser to
    </p>

   <blockquote>
       http://localhost:8080/
   </blockquote>

</section>
 </body>
 </document>





